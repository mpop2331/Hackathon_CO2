"use strict";function peg$subclass(r,t){function e(){this.constructor=r}e.prototype=t.prototype,r.prototype=new e}function peg$SyntaxError(r,t,e,n){this.message=r,this.expected=t,this.found=e,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,peg$SyntaxError)}function peg$parse(r,t){t=void 0!==t?t:{};var e,n={},s={ODataRelativeURI:hn},u=hn,o="/",a=sn("/",!1),c=sn("?",!1),i=sn("&",!1),f="$count",l=sn("$count",!1),h="$ref",p=sn("$ref",!1),A="$value",d=sn("$value",!1),g=function(r){return[r]},v="=",m=sn("=",!1),b="$skiptoken=",y=sn("$skiptoken=",!1),C="$select=",w=sn("$select=",!1),x="$expand=",E=sn("$expand=",!1),$="$filter=",L=sn("$filter=",!1),B="$orderby=",S=sn("$orderby=",!1),T=function(r,t){Ts(t)},_="$top=",O=sn("$top=",!1),R="$skip=",j=sn("$skip=",!1),Z="$search=",N=sn("$search=",!1),k="$count=",z=sn("$count=",!1),D="$apply=",P=sn("$apply=",!1),F=sn("*",!1),U="/$count",q=sn("/$count",!1),M=sn(";",!1),I=function(r){return r?[r]:[]},Y=function(r,t){r.push({xpr:t})},X=function(r,t){r.push({val:t})},J=function(r,t,e){r.push(t,...e)},Q=function(r,t){r.push(...t)},W=function(r,t){r.push(t)},G=function(r,t,e){r.push(t,...e)},H=":",K=sn(":",!1),V="any",rr=sn("any",!1),tr="all",er=sn("all",!1),nr=sn("asc",!1),sr="desc",ur=sn("desc",!1),or=function(r,t){return t},ar=/^[a-zA-Z0-9\-_.~]/,cr=un([["a","z"],["A","Z"],["0","9"],"-","_",".","~"],!1,!1),ir=/^[^&]/,fr=un(["&"],!0,!1),lr=on("an aliased parameter (@param)"),hr=sn("@",!1),pr=on("@alias=value"),Ar="$format=",dr=sn("$format=",!1),gr=sn("eq",!1),vr=sn("ne",!1),mr=sn("lt",!1),br=sn("gt",!1),yr=sn("le",!1),Cr=sn("ge",!1),wr=sn("in",!1),xr=(sn("add",!1),sn("sub",!1),sn("mul",!1),sn("div",!1),sn("mod",!1),on("navigation with $count")),Er=function(r,t){return t},$r=function(r,t){return t?{id:r,where:t}:r},Lr=on("a reference"),Br=function(r,t){return t},Sr=function(r){return{val:r}},Tr=on("null"),_r="null",Or=sn("null",!1),Rr=on("a json object"),jr=sn("{",!1),Zr=/^[^}]/,Nr=un(["}"],!0,!1),kr=sn("}",!1),zr=on("a json array"),Dr="[",Pr=sn("[",!1),Fr="]",Ur=sn("]",!1),qr=/^[^\]]/,Mr=un(["]"],!0,!1),Ir=on("a list"),Yr=",",Xr=sn(",",!1),Jr=function(r,t){return t},Qr=on("a function name"),Wr=/^[a-zA-Z]/,Gr=un([["a","z"],["A","Z"]],!1,!1),Hr=function(r,t){return t},Kr="contains",Vr=sn("contains",!0),rt="endswith",tt=sn("endswith",!0),et="startswith",nt=sn("startswith",!0),st=sn("NOT",!0),ut=sn("AND",!0),ot=sn("OR",!0),at="aggregate",ct=sn("aggregate",!1),it="groupby",ft=sn("groupby",!1),lt="filter",ht=sn("filter",!1),pt="search",At=sn("search",!1),dt="concat",gt=sn("concat",!1),vt="compute",mt=sn("compute",!1),bt=sn("top",!1),yt="skip",Ct=sn("skip",!1),wt="orderby",xt=sn("orderby",!1),Et=sn("topcount",!0),$t=sn("bottomcount",!0),Lt=sn("topsum",!0),Bt=sn("bottomsum",!0),St=sn("toppercent",!0),Tt=sn("bottompercent",!0),_t=function(r,t){return t},Ot="with",Rt=sn("with",!1),jt="from",Zt=sn("from",!1),Nt=sn("as",!1),kt="rollup",zt=sn("rollup",!1),Dt="$all",Pt=sn("$all",!1),Ft=function(r,t){return t},Ut="identity",qt=sn("identity",!1),Mt=function(r,t){return t},It=on("a boolean"),Yt="true",Xt=sn("true",!1),Jt="false",Qt=sn("false",!1),Wt=on("a single quoted string"),Gt="'",Ht=sn("'",!1),Kt="''",Vt=sn("''",!1),re=/^[^']/,te=un(["'"],!0,!1),ee=on("a doubled quoted string"),ne='"',se=sn('"',!1),ue='\\"',oe=sn('\\"',!1),ae=/^[^"]/,ce=un(['"'],!0,!1),ie=on("a string"),fe=/^[^ \t\n()"&;]/,le=un([" ","\t","\n","(",")",'"',"&",";"],!0,!1),he=on("a date"),pe=/^[0-9]/,Ae=un([["0","9"]],!1,!1),de="-",ge=sn("-",!1),ve=sn("T",!1),me=".",be=sn(".",!1),ye=sn("Z",!1),Ce=sn("+",!1),we=on("a number"),xe=/^[+\-]/,Ee=un(["+","-"],!1,!1),$e=sn("e",!1),Le=on("an integer"),Be=on("an identifier"),Se=/^[_a-zA-Z]/,Te=un(["_",["a","z"],["A","Z"]],!1,!1),_e=/^[_a-zA-Z0-9"."]/,Oe=un(["_",["a","z"],["A","Z"],["0","9"],'"',".",'"'],!1,!1),Re=on("a guid"),je=on("a hex value"),Ze=/^[0-9a-fA-F]/,Ne=un([["0","9"],["a","f"],["A","F"]],!1,!1),ke=/^[^\/?]/,ze=un(["/","?"],!0,!1),De=/^[a-zA-Z0-9\-"."_~!$'()*+,;=:@"\/""?"]/,Pe=un([["a","z"],["A","Z"],["0","9"],"-",'"',".",'"',"_","~","!","$","'","(",")","*","+",",",";","=",":","@",'"',"/",'"','"',"?",'"'],!1,!1),Fe=on("a binary"),Ue="binary'",qe=sn("binary'",!1),Me=/^[a-zA-Z0-9\-_]/,Ie=un([["a","z"],["A","Z"],["0","9"],"-","_"],!1,!1),Ye="==",Xe=sn("==",!1),Je=sn("(",!1),Qe=sn(")",!1),We=on("an optional whitespace"),Ge=/^[ \t\n]/,He=un([" ","\t","\n"],!1,!1),Ke=on("a whitespace"),Ve=0,rn=[{line:1,column:1}],tn=0,en=[],nn=0;if("startRule"in t){if(!(t.startRule in s))throw new Error("Can't start parsing from rule \""+t.startRule+'".');u=s[t.startRule]}function sn(r,t){return{type:"literal",text:r,ignoreCase:t}}function un(r,t,e){return{type:"class",parts:r,inverted:t,ignoreCase:e}}function on(r){return{type:"other",description:r}}function an(t){var e,n=rn[t];if(n)return n;for(e=t-1;!rn[e];)e--;for(n={line:(n=rn[e]).line,column:n.column};e<t;)10===r.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return rn[t]=n,n}function cn(r,t){var e=an(r),n=an(t);return{start:{offset:r,line:e.line,column:e.column},end:{offset:t,line:n.line,column:n.column}}}function fn(r){Ve<tn||(Ve>tn&&(tn=Ve,en=[]),en.push(r))}function ln(r,t,e){return new peg$SyntaxError(peg$SyntaxError.buildMessage(r,t),r,t,e)}function hn(){var t,e,s,u,f,l,h,p,A,d,g,v,m,b,y;if(t=Ve,47===r.charCodeAt(Ve)?(e=o,Ve++):(e=n,0===nn&&fn(a)),e===n&&(e=null),e!==n)if(s=Ve,(u=pn())!==n&&(s,u=void(ds=u)),(s=u)!==n){if(u=Ve,(f=is())!==n)if(63===r.charCodeAt(Ve)?(l="?",Ve++):(l=n,0===nn&&fn(c)),l!==n)if((h=is())!==n){if(p=Ve,(A=dn())!==n){for(d=[],g=Ve,(v=is())!==n?(38===r.charCodeAt(Ve)?(m="&",Ve++):(m=n,0===nn&&fn(i)),m!==n&&(b=is())!==n&&(y=dn())!==n?g=v=[v,m,b,y]:(Ve=g,g=n)):(Ve=g,g=n);g!==n;)d.push(g),g=Ve,(v=is())!==n?(38===r.charCodeAt(Ve)?(m="&",Ve++):(m=n,0===nn&&fn(i)),m!==n&&(b=is())!==n&&(y=dn())!==n?g=v=[v,m,b,y]:(Ve=g,g=n)):(Ve=g,g=n);d!==n?p=A=[A,d]:(Ve=p,p=n)}else Ve=p,p=n;p===n&&(p=null),p!==n?u=f=[f,l,h,p]:(Ve=u,u=n)}else Ve=u,u=n;else Ve=u,u=n;else Ve=u,u=n;u===n&&(u=null),u!==n&&(f=is())!==n?(t,t=e=function(){if(gs)return ds.columns=[{args:[{val:1}],as:"$count",func:"count"}],delete ds.expand,delete ds.limit,delete ds.orderBy,ds.apply?Es(ds,ds.apply):{SELECT:ds};let r;if(ds.expand){ds.columns||(ds.columns=["*"],r=!0);for(const r of ds.expand){const t=ds.columns.findIndex(ys(r));t>-1&&ds.columns.splice(t,1),ds.columns.push(r)}delete ds.expand}return ds.count&&ds.apply&&(ds.__countAggregated=!0),ds.apply?Es(ds,ds.apply,r):{SELECT:ds}}()):(Ve=t,t=n)}else Ve=t,t=n;else Ve=t,t=n;return t}function pn(){var t,e,s,u,c,i,v,m;return t=Ve,r.substr(Ve,6)===f?(e=f,Ve+=6):(e=n,0===nn&&fn(l)),e!==n&&(t,e=void(gs=!0)),(t=e)===n&&(t=Ve,e=Ve,r.substr(Ve,4)===h?(s=h,Ve+=4):(s=n,0===nn&&fn(p)),s===n&&(r.substr(Ve,6)===A?(s=A,Ve+=6):(s=n,0===nn&&fn(d))),(e=s!==n?r.substring(e,Ve):s)!==n&&(t,m=e,e=!vs.includes(m)&&{from:{ref:[m]}}),(t=e)===n&&(t=Ve,e=Ve,(s=es())!==n?(u=Ve,(c=as())!==n&&(i=cs())!==n?u=c=[c,i]:(Ve=u,u=n),u===n&&(u=Ve,(c=as())!==n&&(i=An())!==n&&(v=cs())!==n?u=c=[c,i,v]:(Ve=u,u=n)),u===n&&(u=null),u!==n?(c=Ve,nn++,i=us(),nn--,i===n?c=void 0:(Ve=c,c=n),c!==n?e=s=[s,u,c]:(Ve=e,e=n)):(Ve=e,e=n)):(Ve=e,e=n),e===n&&(e=Ve,(s=us())!==n&&(e,s=g(s)),e=s),e===n&&(e=null),e!==n?(s=Ve,u=Ve,47===r.charCodeAt(Ve)?(c=o,Ve++):(c=n,0===nn&&fn(a)),c!==n&&(u,c=c),(u=c)!==n?((c=pn())===n&&(c=null),c!==n?s=u=[u,c]:(Ve=s,s=n)):(Ve=s,s=n),s===n&&(s=null),s!==n?(t,t=e=function(r,t){if(t=t&&t[1],!r&&!t)return{from:{ref:[""]}};if(!r&&t&&t.from)return t.from.ref.unshift(""),t;const[e,n]=r,s=[];if(n?n.length>2?s.push({id:e,where:n[1].map((r=>r.val&&r.val.match&&r.val.match(/^"(.*)"$/)?{val:r.val.match(/^"(.*)"$/)[1]}:r))}):s.push({id:e,where:[]}):ps?s.push(`${"object"==typeof e&&"val"in e?e.val:e}`):"object"==typeof e&&"string"==typeof e.val&&e.val.match(/^[1-9]\d*$|^0$/)?s.push({val:ms(e.val)}):s.push(e),t&&t.from){const r=t.from.ref;Object.prototype.hasOwnProperty.call(r[0],"val")&&(s[s.length-1]={id:s[s.length-1],where:[r.shift()]}),s.push(...r)}const u={from:{ref:s}};return t&&t.columns&&(u.columns=t.columns),u}(e,s)):(Ve=t,t=n)):(Ve=t,t=n))),t}function An(){var t,e,s,u,o,a,c;return t=Ve,(e=zn())!==n&&(t,e=g(e)),(t=e)===n&&(t=Ve,(e=kn())!==n&&is()!==n?(61===r.charCodeAt(Ve)?(s=v,Ve++):(s=n,0===nn&&fn(m)),s!==n&&is()!==n&&(u=zn())!==n?(o=Ve,(a=os())!==n&&(c=An())!==n?o=a=[a,c]:(Ve=o,o=n),o===n&&(o=null),o!==n?(t,t=e=function(r,t,e){const n=[r,"=",t];return e&&n.push("and",...e[1]),n}(e,u,o)):(Ve=t,t=n)):(Ve=t,t=n)):(Ve=t,t=n)),t}function dn(){var t,e,s,u,o;return t=Ve,(e=gn())!==n&&(t,e=void((o=e)&&o.apply&&(ds.apply=o.apply))),(t=e)===n&&(t=Ve,r.substr(Ve,11)===b?(e=b,Ve+=11):(e=n,0===nn&&fn(y)),e!==n&&(s=is())!==n?(u=function(){var t,e,s;t=Ve,(e=ts())===n&&(e=null);e!==n?(s=function(){var t,e,s;t=Ve,e=[],De.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(Pe));if(s!==n)for(;s!==n;)e.push(s),De.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(Pe));else e=n;t=e!==n?r.substring(t,Ve):e;return t}(),s===n&&(s=null),s!==n?(t,u=e,t=e=void(s||Ss(u))):(Ve=t,t=n)):(Ve=t,t=n);var u;return t}(),u!==n?t=e=[e,s,u]:(Ve=t,t=n)):(Ve=t,t=n),t===n&&(t=function(){var t,e,s,u,o;t=Ve,r.substr(Ve,8)===Ar?(e=Ar,Ve+=8):(e=n,0===nn&&fn(dr));if(e!==n){for(s=Ve,u=[],ir.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(fr));o!==n;)u.push(o),ir.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(fr));(s=u!==n?r.substring(s,Ve):u)!==n?(t,t=e=function(r){if("json"!==r.toLowerCase()){const r=new Error("ONLY_QUERY_PARAM_FORMAT_JSON_ALLOWED");throw r.statusCode=501,r}}(s)):(Ve=t,t=n)}else Ve=t,t=n;return t}(),t===n&&(t=function(){var t,e,s,u,o;t=Ve,e=[],ar.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(cr));if(s!==n)for(;s!==n;)e.push(s),ar.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(cr));else e=n;if(e!==n)if(61===r.charCodeAt(Ve)?(s=v,Ve++):(s=n,0===nn&&fn(m)),s!==n){for(u=[],ir.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(fr));o!==n;)u.push(o),ir.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(fr));u!==n?t=e=[e,s,u]:(Ve=t,t=n)}else Ve=t,t=n;else Ve=t,t=n;return t}(),t===n&&(t=function(){var t,e,s,u,o;if(nn++,t=Ve,(e=Rn())!==n)if(61===r.charCodeAt(Ve)?(s=v,Ve++):(s=n,0===nn&&fn(m)),s!==n){for(u=[],ir.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(fr));o!==n;)u.push(o),ir.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(fr));u!==n?(t,t=e=e+"="+u):(Ve=t,t=n)}else Ve=t,t=n;else Ve=t,t=n;nn--,t===n&&(e=n,0===nn&&fn(pr));return t}())))),t}function gn(){var t,e,s,u,o,a,c,i,f,l,h;if(t=Ve,r.substr(Ve,8)===C?(e=C,Ve+=8):(e=n,0===nn&&fn(w)),e!==n)if((s=is())!==n)if((u=vn())!==n){for(o=[],a=Ve,(c=os())!==n&&(i=vn())!==n?a=c=[c,i]:(Ve=a,a=n);a!==n;)o.push(a),a=Ve,(c=os())!==n&&(i=vn())!==n?a=c=[c,i]:(Ve=a,a=n);o!==n?t=e=[e,s,u,o]:(Ve=t,t=n)}else Ve=t,t=n;else Ve=t,t=n;else Ve=t,t=n;if(t===n){if(t=Ve,r.substr(Ve,8)===x?(e=x,Ve+=8):(e=n,0===nn&&fn(E)),e!==n)if((s=is())!==n)if((u=yn())!==n){for(o=[],a=Ve,(c=os())!==n&&(i=yn())!==n?a=c=[c,i]:(Ve=a,a=n);a!==n;)o.push(a),a=Ve,(c=os())!==n&&(i=yn())!==n?a=c=[c,i]:(Ve=a,a=n);o!==n?(a=function(){var t,e;t=Ve,r.substr(Ve,7)===U?(e=U,Ve+=7):(e=n,0===nn&&fn(q));e!==n&&(t,e=function(){const r=new Error("EXPAND_COUNT_UNSUPPORTED");throw r.statusCode=501,r}());return t=e}(),a===n&&(a=null),a!==n?t=e=[e,s,u,o,a]:(Ve=t,t=n)):(Ve=t,t=n)}else Ve=t,t=n;else Ve=t,t=n;else Ve=t,t=n;if(t===n&&(t=Ve,r.substr(Ve,8)===$?(e=$,Ve+=8):(e=n,0===nn&&fn(L)),e!==n&&(s=is())!==n&&(u=$n())!==n?(t,h=u,t=e=void(ds.where=h)):(Ve=t,t=n),t===n)){if(t=Ve,r.substr(Ve,9)===B?(e=B,Ve+=9):(e=n,0===nn&&fn(S)),e!==n)if((s=is())!==n)if((u=_n())!==n){for(o=[],a=Ve,(c=os())!==n&&(i=_n())!==n?(a,a=c=T(0,i)):(Ve=a,a=n);a!==n;)o.push(a),a=Ve,(c=os())!==n&&(i=_n())!==n?(a,a=c=T(0,i)):(Ve=a,a=n);o!==n?(t,t=e=void Ts(u,!0)):(Ve=t,t=n)}else Ve=t,t=n;else Ve=t,t=n;else Ve=t,t=n;t===n&&(t=Ve,r.substr(Ve,5)===_?(e=_,Ve+=5):(e=n,0===nn&&fn(O)),e!==n&&(s=is())!==n&&(u=Cn())!==n?(t,l=u,t=e=void((ds.limit||(ds.limit={})).rows={val:l})):(Ve=t,t=n),t===n&&(t=Ve,r.substr(Ve,6)===R?(e=R,Ve+=6):(e=n,0===nn&&fn(j)),e!==n&&(s=is())!==n&&(u=wn())!==n?(t,e=function(r){Ss(r)}(u),t=e):(Ve=t,t=n),t===n&&(t=Ve,r.substr(Ve,8)===Z?(e=Z,Ve+=8):(e=n,0===nn&&fn(N)),e!==n&&(s=is())!==n&&(u=xn())!==n?(t,t=e=void((f=u)&&(ds.search=f))):(Ve=t,t=n),t===n&&(t=Ve,r.substr(Ve,7)===k?(e=k,Ve+=7):(e=n,0===nn&&fn(z)),e!==n&&(s=is())!==n?(u=function(){var r,t;r=Ve,(t=Vn())!==n&&(r,t=function(r){r&&(ds.count=!0)}(t));return r=t}(),u!==n?t=e=[e,s,u]:(Ve=t,t=n)):(Ve=t,t=n),t===n&&(t=Ve,r.substr(Ve,7)===D?(e=D,Ve+=7):(e=n,0===nn&&fn(P)),e!==n&&(s=is())!==n&&(u=On())!==n?(t,t=e=u):(Ve=t,t=n))))))}}return t}function vn(){var t,e,s;return t=Ve,42===r.charCodeAt(Ve)?(e="*",Ve++):(e=n,0===nn&&fn(F)),e===n&&(e=kn()),e!==n&&(t,s=e,ds.columns=Array.isArray(ds.columns)?ds.columns:[],ds.columns.find(ys(s))||ds.columns.push(s),e=s),t=e}function mn(){var t,e,s,u,o;for(t=Ve,e=[],s=Ve,(u=gn())!==n&&is()!==n?(59===r.charCodeAt(Ve)?(o=";",Ve++):(o=n,0===nn&&fn(M)),o===n&&(o=null),o!==n?(s,s=u):(Ve=s,s=n)):(Ve=s,s=n);s!==n;)e.push(s),s=Ve,(u=gn())!==n&&is()!==n?(59===r.charCodeAt(Ve)?(o=";",Ve++):(o=n,0===nn&&fn(M)),o===n&&(o=null),o!==n?(s,s=u):(Ve=s,s=n)):(Ve=s,s=n);return e!==n&&(t,e=function(r){if(r.find((r=>r&&void 0!==r.apply))){const r=new Error("EXPAND_APPLY_UNSUPPORTED");throw r.statusCode=501,r}if(ds.columns){"*"===ds.expand&&(ds.expand=[]);for(const r of ds.columns)ds.expand.find(ys(r))||ds.expand.push(r);delete ds.columns}else Array.isArray(ds.expand)&&-1===ds.expand.indexOf("*")&&ds.expand.unshift("*")}(e)),t=e}function bn(){var r,t,e,s,u;return r=Ve,t=Ve,(e=as())!==n&&(t,As.push(ds),ds=ds.expand[ds.expand.length-1],e=void(ds.expand="*")),(t=e)!==n?((e=mn())===n&&(e=null),e!==n?(s=Ve,(u=cs())!==n&&(s,u=void(ds=As.pop())),(s=u)!==n?r=t=[t,e,s]:(Ve=r,r=n)):(Ve=r,r=n)):(Ve=r,r=n),r}function yn(){var t,e,s;return t=Ve,e=Ve,42===r.charCodeAt(Ve)?(s="*",Ve++):(s=n,0===nn&&fn(F)),s===n&&(s=kn()),s!==n&&(e,s=function(r){const t="*"===r?{}:r;return t.expand="*",Array.isArray(ds.expand)||(ds.expand=[]),ds.expand.find(ys(t))||ds.expand.push(t),t}(s)),(e=s)!==n?((s=bn())===n&&(s=null),s!==n?t=e=[e,s]:(Ve=t,t=n)):(Ve=t,t=n),t}function Cn(){var r,t;return r=Ve,(t=ts())!==n&&r,r=t}function wn(){var r,t;return r=Ve,(t=ts())!==n&&r,r=t}function xn(){var r,t;return r=Ve,(t=En())!==n&&r,(r=t)===n&&(r=is()),r}function En(){var t,e,s,u,o,a,c;if(t=Ve,e=Ve,(s=Un())===n&&(s=null),s!==n&&(e,s=I(s)),(e=s)!==n)if(s=Ve,(u=as())!==n&&(o=En())!==n&&(a=cs())!==n?(s,s=u=Y(e,o)):(Ve=s,s=n),s===n&&(s=Ve,u=function(){var t,e,s,u,o;nn++,t=Ve,34===r.charCodeAt(Ve)?(e=ne,Ve++):(e=n,0===nn&&fn(se));if(e!==n){for(s=Ve,u=[],r.substr(Ve,2)===ue?(o=ue,Ve+=2):(o=n,0===nn&&fn(oe)),o===n&&(ae.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(ce)));o!==n;)u.push(o),r.substr(Ve,2)===ue?(o=ue,Ve+=2):(o=n,0===nn&&fn(oe)),o===n&&(ae.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(ce)));(s=u!==n?r.substring(s,Ve):u)!==n?(34===r.charCodeAt(Ve)?(u=ne,Ve++):(u=n,0===nn&&fn(se)),u!==n?(t,t=e=s.replace(/\\\\/g,"\\").replace(/\\"/g,'"')):(Ve=t,t=n)):(Ve=t,t=n)}else Ve=t,t=n;nn--,t===n&&(e=n,0===nn&&fn(ee));return t}(),u!==n&&(s,u=X(e,u)),(s=u)===n&&(s=Ve,(u=rs())!==n&&(s,u=X(e,u)),(s=u)===n&&(s=Ve,u=function(){var t,e,s;nn++,t=Ve,e=[],fe.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(le));if(s!==n)for(;s!==n;)e.push(s),fe.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(le));else e=n;t=e!==n?r.substring(t,Ve):e;nn--,t===n&&(e=n,0===nn&&fn(ie));return t}(),u!==n&&(s,u=X(e,u)),s=u))),s!==n){for(u=[],o=Ve,(a=qn())===n&&(a=In())===n&&(a=Mn()),a!==n&&(c=En())!==n?(o,o=a=J(e,a,c)):(Ve=o,o=n);o!==n;)u.push(o),o=Ve,(a=qn())===n&&(a=In())===n&&(a=Mn()),a!==n&&(c=En())!==n?(o,o=a=J(e,a,c)):(Ve=o,o=n);u!==n?(t,t=e):(Ve=t,t=n)}else Ve=t,t=n;else Ve=t,t=n;return t}function $n(){var r,t;return r=Ve,(t=Ln())!==n&&r,r=t}function Ln(){var t,e,s,u,o,a,c,i;if(t=Ve,e=Ve,(s=Un())===n&&(s=null),s!==n&&(e,s=I(s)),(e=s)!==n)if(s=Ve,(u=as())!==n&&(o=Ln())!==n&&(a=cs())!==n?(s,s=u=Y(e,o)):(Ve=s,s=n),s===n&&(s=Ve,(u=jn())!==n&&(s,i=u,u=void e.push(...i)),(s=u)===n&&(s=Ve,(u=Bn())!==n&&(s,u=function(r,t){"not"===r[r.length-1]&&"not"===t[0]?r.push("(",...t,")"):r.push(...t)}(e,u)),(s=u)===n&&(s=Ve,u=function(){var t,e,s,u;t=Ve,r.substr(Ve,8).toLowerCase()===Kr?(e=r.substr(Ve,8),Ve+=8):(e=n,0===nn&&fn(Vr));e===n&&(r.substr(Ve,8).toLowerCase()===rt?(e=r.substr(Ve,8),Ve+=8):(e=n,0===nn&&fn(tt)),e===n&&(r.substr(Ve,10).toLowerCase()===et?(e=r.substr(Ve,10),Ve+=10):(e=n,0===nn&&fn(nt))));e!==n&&as()!==n&&(s=Nn())!==n&&os()!==n&&(u=Nn())!==n&&cs()!==n?(t,o=s,a=u,t=e={func:e.toLowerCase(),args:[o,a]}):(Ve=t,t=n);var o,a;return t}(),u!==n&&(s,u=function(r,t){r.push(t)}(e,u)),(s=u)===n&&(s=Ve,(u=Vn())!==n&&(s,u=X(e,u)),(s=u)===n&&(s=Ve,(u=Zn())!==n&&(s,u=Q(e,u)),s=u))))),s!==n){for(u=[],o=Ve,(a=qn())===n&&(a=In()),a!==n&&(c=Ln())!==n?(o,o=a=J(e,a,c)):(Ve=o,o=n);o!==n;)u.push(o),o=Ve,(a=qn())===n&&(a=In()),a!==n&&(c=Ln())!==n?(o,o=a=J(e,a,c)):(Ve=o,o=n);u!==n?(t,t=e):(Ve=t,t=n)}else Ve=t,t=n;else Ve=t,t=n;return t}function Bn(){var t,e,s,u,c,i,f;if(t=Ve,e=Ve,(s=es())!==n&&(e,s=[s]),(e=s)!==n)if(47===r.charCodeAt(Ve)?(s=o,Ve++):(s=n,0===nn&&fn(a)),s!==n){for(u=[],c=Ve,(i=es())!==n?(47===r.charCodeAt(Ve)?(f=o,Ve++):(f=n,0===nn&&fn(a)),f!==n?(c,c=i=W(e,i)):(Ve=c,c=n)):(Ve=c,c=n);c!==n;)u.push(c),c=Ve,(i=es())!==n?(47===r.charCodeAt(Ve)?(f=o,Ve++):(f=n,0===nn&&fn(a)),f!==n?(c,c=i=W(e,i)):(Ve=c,c=n)):(Ve=c,c=n);u!==n?(c=Ve,i=function(){var t,e,s;t=Ve,r.substr(Ve,3)===V?(e=V,Ve+=3):(e=n,0===nn&&fn(rr));e!==n&&as()!==n?((s=Tn())===n&&(s=null),s!==n&&cs()!==n?(t,t=e=s):(Ve=t,t=n)):(Ve=t,t=n);return t}(),i!==n&&(c,i=function(r,t){let e=r.pop();if(!t)return["exists",{ref:[...r,{id:e}]}];let n=[];for(let r=0,s=0;r<t.length;++r){let u=t[r];u.ref&&0===u.ref.length&&"="===t[r+1]?n[s++]={func:"contains",args:[{ref:e},t[r+=2]]}:n[s++]=u}return n.length<t.length?(e=r.pop(),["exists",{ref:[...r,{id:e,where:n}]}]):["exists",{ref:[...r,{id:e,where:t}]}]}(e,i)),(c=i)===n&&(c=Ve,i=function(){var t,e,s;t=Ve,r.substr(Ve,3)===tr?(e=tr,Ve+=3):(e=n,0===nn&&fn(er));e!==n&&as()!==n&&(s=Tn())!==n&&cs()!==n?(t,t=e=s):(Ve=t,t=n);return t}(),i!==n&&(c,i=function(r,t){let e=r.pop();return["not","exists",{ref:[...r,{id:e,where:["not",{xpr:[...t]}]}]}]}(e,i)),c=i),c!==n?(t,t=e=c):(Ve=t,t=n)):(Ve=t,t=n)}else Ve=t,t=n;else Ve=t,t=n;return t}function Sn(){var r,t,e,s,u,o,a,c,i;if(r=Ve,t=Ve,(e=Un())===n&&(e=null),e!==n&&(t,e=(c=e)?[c]:[]),(t=e)!==n)if(e=Ve,(s=as())!==n&&(u=Sn())!==n&&(o=cs())!==n?(e,i=u,e=s=void t.push("(",...i,")")):(Ve=e,e=n),e===n&&(e=Ve,(s=jn())!==n&&(e,s=function(r,t){r.push(...t)}(t,s)),(e=s)===n&&(e=Ve,(s=Fn())!==n&&(e,s=function(r,t){r.push(t)}(t,s)),(e=s)===n&&(e=Ve,(s=Bn())!==n&&(e,s=function(r,t){r.push(...t)}(t,s)),(e=s)===n&&(e=Ve,(s=Zn())!==n&&(e,s=Q(t,s)),e=s)))),e!==n){for(s=[],u=Ve,(o=qn())===n&&(o=In()),o!==n&&(a=Sn())!==n?(u,u=o=G(t,o,a)):(Ve=u,u=n);u!==n;)s.push(u),u=Ve,(o=qn())===n&&(o=In()),o!==n&&(a=Sn())!==n?(u,u=o=G(t,o,a)):(Ve=u,u=n);s!==n?(r,r=t):(Ve=r,r=n)}else Ve=r,r=n;else Ve=r,r=n;return r}function Tn(){var t,e,s,u;return t=Ve,(e=es())!==n?(58===r.charCodeAt(Ve)?(s=H,Ve++):(s=n,0===nn&&fn(K)),s!==n&&(u=Sn())!==n?(t,t=e=_s(e,u)):(Ve=t,t=n)):(Ve=t,t=n),t}function _n(){var t,e,s,u,o,a;return t=Ve,e=Ve,(s=Bn())!==n&&(e,s=function(){const r=new Error("ORDERBY_LAMBDA_UNSUPPORTED");throw r.statusCode=501,r}()),(e=s)===n&&(e=Fn())===n&&(e=kn()),e!==n?(s=Ve,fs()!==n?(u=Ve,"asc"===r.substr(Ve,3)?(o="asc",Ve+=3):(o=n,0===nn&&fn(nr)),o===n&&(r.substr(Ve,4)===sr?(o=sr,Ve+=4):(o=n,0===nn&&fn(ur))),(u=o!==n?r.substring(u,Ve):o)!==n?(s,s=u):(Ve=s,s=n)):(Ve=s,s=n),s===n&&(s=null),s!==n?(t,t=e=ls(e,(a=s)&&{sort:a})):(Ve=t,t=n)):(Ve=t,t=n),t}function On(){var t,e,s,u,c,i;if(t=Ve,(e=Yn())!==n){for(s=[],u=Ve,47===r.charCodeAt(Ve)?(c=o,Ve++):(c=n,0===nn&&fn(a)),c!==n&&(i=Yn())!==n?(u,u=c=or(0,i)):(Ve=u,u=n);u!==n;)s.push(u),u=Ve,47===r.charCodeAt(Ve)?(c=o,Ve++):(c=n,0===nn&&fn(a)),c!==n&&(i=Yn())!==n?(u,u=c=or(0,i)):(Ve=u,u=n);s!==n?(t,t=e=function(r,t){if(void 0!==r){t=Array.isArray(t)?t:[t];for(let e of t)for(const t in e)if("limit"===t&&e.limit&&r.limit&&r.limit.offset&&e.limit.rows)r.limit.rows=e.limit.rows;else if(r[t]||"groupBy"===t&&(r.where||r.search)||"aggregate"===t&&"groupBy"in r&&!("groupBy"in e)){let n=r;r={apply:n},"limit"===t&&e[t].offset&&n.limit&&n.limit.offset&&n.limit.offset.val&&(e[t].offset+=n.limit.offset.val),n=r,n[t]=e[t]}else r[t]=e[t];return{apply:r}}}(e,s)):(Ve=t,t=n)}else Ve=t,t=n;return t}function Rn(){var t,e,s;return nn++,t=Ve,64===r.charCodeAt(Ve)?(e="@",Ve++):(e=n,0===nn&&fn(hr)),e!==n&&(s=es())!==n?(t,t=e="@"+s):(Ve=t,t=n),nn--,t===n&&(e=n,0===nn&&fn(lr)),t}function jn(){var t,e,s,u,o,a;return t=Ve,(e=Nn())!==n&&fs()!==n?(s=Ve,"eq"===r.substr(Ve,2)?(u="eq",Ve+=2):(u=n,0===nn&&fn(gr)),u===n&&("ne"===r.substr(Ve,2)?(u="ne",Ve+=2):(u=n,0===nn&&fn(vr)),u===n&&("lt"===r.substr(Ve,2)?(u="lt",Ve+=2):(u=n,0===nn&&fn(mr)),u===n&&("gt"===r.substr(Ve,2)?(u="gt",Ve+=2):(u=n,0===nn&&fn(br)),u===n&&("le"===r.substr(Ve,2)?(u="le",Ve+=2):(u=n,0===nn&&fn(yr)),u===n&&("ge"===r.substr(Ve,2)?(u="ge",Ve+=2):(u=n,0===nn&&fn(Cr))))))),(s=u!==n?r.substring(s,Ve):u)!==n&&(u=fs())!==n&&(o=Nn())!==n?(t,t=e=[e,{eq:"=",ne:"!=",lt:"<",gt:">",le:"<=",ge:">="}[a=s]||a,o]):(Ve=t,t=n)):(Ve=t,t=n),t}function Zn(){var t,e,s,u;return t=Ve,(e=Nn())!==n&&fs()!==n?("in"===r.substr(Ve,2)?(s="in",Ve+=2):(s=n,0===nn&&fn(wr)),s!==n&&fs()!==n?(u=function(){var t,e,s,u,o,a,c;if(nn++,t=Ve,as()!==n){if(e=Ve,(s=zn())!==n){for(u=[],o=Ve,44===r.charCodeAt(Ve)?(a=Yr,Ve++):(a=n,0===nn&&fn(Xr)),a!==n&&(c=zn())!==n?(o,o=a=Jr(0,c)):(Ve=o,o=n);o!==n;)u.push(o),o=Ve,44===r.charCodeAt(Ve)?(a=Yr,Ve++):(a=n,0===nn&&fn(Xr)),a!==n&&(c=zn())!==n?(o,o=a=Jr(0,c)):(Ve=o,o=n);u!==n?(e,i=u,e=s=[s,...i]):(Ve=e,e=n)}else Ve=e,e=n;e!==n&&(s=cs())!==n?(t,t={list:e}):(Ve=t,t=n)}else Ve=t,t=n;var i;nn--,t===n&&(n,0===nn&&fn(Ir));return t}(),u!==n?(t,t=e=[e,"in",u]):(Ve=t,t=n)):(Ve=t,t=n)):(Ve=t,t=n),t}function Nn(){var t;return(t=function(){var t,e,s,u,c,i,h;nn++,t=Ve,e=[],s=Ve,(u=es())!==n?(c=Ve,(i=as())!==n&&(h=An())!==n&&cs()!==n?(c,c=i=Er(0,h)):(Ve=c,c=n),c===n&&(c=null),c!==n?(47===r.charCodeAt(Ve)?(i=o,Ve++):(i=n,0===nn&&fn(a)),i!==n?(s,s=u=$r(u,c)):(Ve=s,s=n)):(Ve=s,s=n)):(Ve=s,s=n);if(s!==n)for(;s!==n;)e.push(s),s=Ve,(u=es())!==n?(c=Ve,(i=as())!==n&&(h=An())!==n&&cs()!==n?(c,c=i=Er(0,h)):(Ve=c,c=n),c===n&&(c=null),c!==n?(47===r.charCodeAt(Ve)?(i=o,Ve++):(i=n,0===nn&&fn(a)),i!==n?(s,s=u=$r(u,c)):(Ve=s,s=n)):(Ve=s,s=n)):(Ve=s,s=n);else e=n;e!==n?(r.substr(Ve,6)===f?(s=f,Ve+=6):(s=n,0===nn&&fn(l)),s!==n?(t,t=e={func:"count",as:"$count",args:[{ref:e}]}):(Ve=t,t=n)):(Ve=t,t=n);nn--,t===n&&(e=n,0===nn&&fn(xr));return t}())===n&&(t=Fn())===n&&(t=zn())===n&&(t=kn())===n&&(t=Dn())===n&&(t=Pn())===n&&(t=function(){var t,e,s,u,o;nn++,t=Ve,91===r.charCodeAt(Ve)?(e=Dr,Ve++):(e=n,0===nn&&fn(Pr));if(e!==n){for(s=Ve,u=[],qr.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(Mr));o!==n;)u.push(o),qr.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(Mr));(s=u!==n?r.substring(s,Ve):u)!==n?(93===r.charCodeAt(Ve)?(u=Fr,Ve++):(u=n,0===nn&&fn(Ur)),u!==n?(t,t=e={list:s.replace(/"/g,"").split(",").map((r=>({val:r})))}):(Ve=t,t=n)):(Ve=t,t=n)}else Ve=t,t=n;nn--,t===n&&(e=n,0===nn&&fn(Ir));return t}()),t}function kn(){var t,e,s,u,c,i,f,l;if(nn++,t=Ve,(e=es())!==n){for(s=[],u=Ve,47===r.charCodeAt(Ve)?(c=o,Ve++):(c=n,0===nn&&fn(a)),c!==n&&(i=es())!==n?(u,u=c=Br(0,i)):(Ve=u,u=n);u!==n;)s.push(u),u=Ve,47===r.charCodeAt(Ve)?(c=o,Ve++):(c=n,0===nn&&fn(a)),c!==n&&(i=es())!==n?(u,u=c=Br(0,i)):(Ve=u,u=n);s!==n?(t,l=s,t=e="null"===(f=e)?{val:null}:{ref:[f,...l]}):(Ve=t,t=n)}else Ve=t,t=n;return nn--,t===n&&(e=n,0===nn&&fn(Lr)),t}function zn(){var t,e,s;return t=Ve,(e=Vn())===n&&(e=function(){var t,e,s,u,o,a,c,i,f,l,h,p,A,d,g,v,m,b,y,C,w,x,E,$,L;nn++,t=Ve,e=Ve,s=Ve,u=[],pe.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(Ae));if(o!==n)for(;o!==n;)u.push(o),pe.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(Ae));else u=n;if(u!==n)if(45===r.charCodeAt(Ve)?(o=de,Ve++):(o=n,0===nn&&fn(ge)),o!==n)if(pe.test(r.charAt(Ve))?(a=r.charAt(Ve),Ve++):(a=n,0===nn&&fn(Ae)),a!==n)if(pe.test(r.charAt(Ve))?(c=r.charAt(Ve),Ve++):(c=n,0===nn&&fn(Ae)),c!==n)if(45===r.charCodeAt(Ve)?(i=de,Ve++):(i=n,0===nn&&fn(ge)),i!==n)if(pe.test(r.charAt(Ve))?(f=r.charAt(Ve),Ve++):(f=n,0===nn&&fn(Ae)),f!==n)if(pe.test(r.charAt(Ve))?(l=r.charAt(Ve),Ve++):(l=n,0===nn&&fn(Ae)),l!==n){if(h=Ve,84===r.charCodeAt(Ve)?(p="T",Ve++):(p=n,0===nn&&fn(ve)),p!==n)if(pe.test(r.charAt(Ve))?(A=r.charAt(Ve),Ve++):(A=n,0===nn&&fn(Ae)),A!==n)if(pe.test(r.charAt(Ve))?(d=r.charAt(Ve),Ve++):(d=n,0===nn&&fn(Ae)),d!==n)if(58===r.charCodeAt(Ve)?(g=H,Ve++):(g=n,0===nn&&fn(K)),g!==n)if(pe.test(r.charAt(Ve))?(v=r.charAt(Ve),Ve++):(v=n,0===nn&&fn(Ae)),v!==n)if(pe.test(r.charAt(Ve))?(m=r.charAt(Ve),Ve++):(m=n,0===nn&&fn(Ae)),m!==n){if(b=Ve,58===r.charCodeAt(Ve)?(y=H,Ve++):(y=n,0===nn&&fn(K)),y!==n)if(pe.test(r.charAt(Ve))?(C=r.charAt(Ve),Ve++):(C=n,0===nn&&fn(Ae)),C!==n)if(pe.test(r.charAt(Ve))?(w=r.charAt(Ve),Ve++):(w=n,0===nn&&fn(Ae)),w!==n){if(x=Ve,46===r.charCodeAt(Ve)?(E=".",Ve++):(E=n,0===nn&&fn(be)),E!==n){if($=[],pe.test(r.charAt(Ve))?(L=r.charAt(Ve),Ve++):(L=n,0===nn&&fn(Ae)),L!==n)for(;L!==n;)$.push(L),pe.test(r.charAt(Ve))?(L=r.charAt(Ve),Ve++):(L=n,0===nn&&fn(Ae));else $=n;$!==n?x=E=[E,$]:(Ve=x,x=n)}else Ve=x,x=n;x===n&&(x=null),x!==n?b=y=[y,C,w,x]:(Ve=b,b=n)}else Ve=b,b=n;else Ve=b,b=n;else Ve=b,b=n;b===n&&(b=null),b!==n?(90===r.charCodeAt(Ve)?(y="Z",Ve++):(y=n,0===nn&&fn(ye)),y===n&&(y=Ve,43===r.charCodeAt(Ve)?(C="+",Ve++):(C=n,0===nn&&fn(Ce)),C===n&&(45===r.charCodeAt(Ve)?(C=de,Ve++):(C=n,0===nn&&fn(ge))),C!==n?(pe.test(r.charAt(Ve))?(w=r.charAt(Ve),Ve++):(w=n,0===nn&&fn(Ae)),w!==n?(pe.test(r.charAt(Ve))?(x=r.charAt(Ve),Ve++):(x=n,0===nn&&fn(Ae)),x!==n?(58===r.charCodeAt(Ve)?(E=H,Ve++):(E=n,0===nn&&fn(K)),E!==n?(pe.test(r.charAt(Ve))?($=r.charAt(Ve),Ve++):($=n,0===nn&&fn(Ae)),$!==n?(pe.test(r.charAt(Ve))?(L=r.charAt(Ve),Ve++):(L=n,0===nn&&fn(Ae)),L!==n?y=C=[C,w,x,E,$,L]:(Ve=y,y=n)):(Ve=y,y=n)):(Ve=y,y=n)):(Ve=y,y=n)):(Ve=y,y=n)):(Ve=y,y=n)),y===n&&(y=null),y!==n?h=p=[p,A,d,g,v,m,b,y]:(Ve=h,h=n)):(Ve=h,h=n)}else Ve=h,h=n;else Ve=h,h=n;else Ve=h,h=n;else Ve=h,h=n;else Ve=h,h=n;else Ve=h,h=n;h===n&&(h=null),h!==n?s=u=[u,o,a,c,i,f,l,h]:(Ve=s,s=n)}else Ve=s,s=n;else Ve=s,s=n;else Ve=s,s=n;else Ve=s,s=n;else Ve=s,s=n;else Ve=s,s=n;else Ve=s,s=n;e=s!==n?r.substring(e,Ve):s;e!==n&&(t,e=function(r){if(r.split("-")[0].length>4)throw Object.assign(new Error(`The type 'Edm.DateTimeOffset' is not compatible with '${r}'`),{statusCode:400});return r}(e));nn--,(t=e)===n&&(e=n,0===nn&&fn(he));return t}()),e!==n&&(t,e=Sr(e)),(t=e)===n&&(t=Ve,(e=ns())!==n&&(t,e=Sr(e)),(t=e)===n&&(t=Ve,e=function(){var t,e,s,u,o,a,c,i,f,l,h;nn++,t=Ve,e=Ve,nn++,s=function(){var t,e,s;t=Ve,e=[],pe.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(Ae));if(s!==n)for(;s!==n;)e.push(s),pe.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(Ae));else e=n;e!==n?(45===r.charCodeAt(Ve)?(s=de,Ve++):(s=n,0===nn&&fn(ge)),s!==n?t=e=[e,s]:(Ve=t,t=n)):(Ve=t,t=n);return t}(),nn--,s===n?e=void 0:(Ve=e,e=n);if(e!==n){if(s=Ve,u=Ve,xe.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(Ee)),o===n&&(o=null),o!==n){if(a=[],pe.test(r.charAt(Ve))?(c=r.charAt(Ve),Ve++):(c=n,0===nn&&fn(Ae)),c!==n)for(;c!==n;)a.push(c),pe.test(r.charAt(Ve))?(c=r.charAt(Ve),Ve++):(c=n,0===nn&&fn(Ae));else a=n;if(a!==n){if(c=Ve,46===r.charCodeAt(Ve)?(i=me,Ve++):(i=n,0===nn&&fn(be)),i!==n){if(f=[],pe.test(r.charAt(Ve))?(l=r.charAt(Ve),Ve++):(l=n,0===nn&&fn(Ae)),l!==n)for(;l!==n;)f.push(l),pe.test(r.charAt(Ve))?(l=r.charAt(Ve),Ve++):(l=n,0===nn&&fn(Ae));else f=n;f!==n?c=i=[i,f]:(Ve=c,c=n)}else Ve=c,c=n;if(c===n&&(c=null),c!==n){if(i=Ve,101===r.charCodeAt(Ve)?(f="e",Ve++):(f=n,0===nn&&fn($e)),f!==n){if(l=[],pe.test(r.charAt(Ve))?(h=r.charAt(Ve),Ve++):(h=n,0===nn&&fn(Ae)),h!==n)for(;h!==n;)l.push(h),pe.test(r.charAt(Ve))?(h=r.charAt(Ve),Ve++):(h=n,0===nn&&fn(Ae));else l=n;l!==n?i=f=[f,l]:(Ve=i,i=n)}else Ve=i,i=n;i===n&&(i=null),i!==n?u=o=[o,a,c,i]:(Ve=u,u=n)}else Ve=u,u=n}else Ve=u,u=n}else Ve=u,u=n;(s=u!==n?r.substring(s,Ve):u)!==n?(t,t=e=ms(s)):(Ve=t,t=n)}else Ve=t,t=n;nn--,t===n&&(e=n,0===nn&&fn(we));return t}(),e!==n&&(t,e="number"==typeof(s=e)?{val:s}:{val:s,literal:"number"}),(t=e)===n&&(t=Ve,(e=rs())!==n&&(t,e=Sr(e)),(t=e)===n&&(t=Ve,e=function(){var t,e,s,u,o,a;nn++,t=Ve,r.substr(Ve,7)===Ue?(e=Ue,Ve+=7):(e=n,0===nn&&fn(qe));if(e!==n){if(s=Ve,u=Ve,o=[],Me.test(r.charAt(Ve))?(a=r.charAt(Ve),Ve++):(a=n,0===nn&&fn(Ie)),a!==n)for(;a!==n;)o.push(a),Me.test(r.charAt(Ve))?(a=r.charAt(Ve),Ve++):(a=n,0===nn&&fn(Ie));else o=n;o!==n?(r.substr(Ve,2)===Ye?(a=Ye,Ve+=2):(a=n,0===nn&&fn(Xe)),a===n&&(61===r.charCodeAt(Ve)?(a=v,Ve++):(a=n,0===nn&&fn(m))),a===n&&(a=null),a!==n?u=o=[o,a]:(Ve=u,u=n)):(Ve=u,u=n),(s=u!==n?r.substring(s,Ve):u)!==n?(39===r.charCodeAt(Ve)?(u=Gt,Ve++):(u=n,0===nn&&fn(Ht)),u!==n?(t,t=e=bs(s)):(Ve=t,t=n)):(Ve=t,t=n)}else Ve=t,t=n;nn--,t===n&&(e=n,0===nn&&fn(Fe));return t}(),e!==n&&(t,e=Sr(e)),(t=e)===n&&(t=Ve,(e=Rn())!==n&&(t,e=Sr(e)),(t=e)===n&&(t=function(){var t,e;nn++,t=Ve,r.substr(Ve,4)===_r?(e=_r,Ve+=4):(e=n,0===nn&&fn(Or));e!==n&&(t,e={val:null});nn--,(t=e)===n&&(e=n,0===nn&&fn(Tr));return t}())))))),t}function Dn(){var t,e,s,u,o,a;if(nn++,t=Ve,e=Ve,s=Ve,123===r.charCodeAt(Ve)?(u="{",Ve++):(u=n,0===nn&&fn(jr)),u!==n){for(o=[],(a=Dn())===n&&(Zr.test(r.charAt(Ve))?(a=r.charAt(Ve),Ve++):(a=n,0===nn&&fn(Nr)));a!==n;)o.push(a),(a=Dn())===n&&(Zr.test(r.charAt(Ve))?(a=r.charAt(Ve),Ve++):(a=n,0===nn&&fn(Nr)));o!==n?(125===r.charCodeAt(Ve)?(a="}",Ve++):(a=n,0===nn&&fn(kr)),a!==n?s=u=[u,o,a]:(Ve=s,s=n)):(Ve=s,s=n)}else Ve=s,s=n;return(e=s!==n?r.substring(e,Ve):s)!==n&&(t,e=Sr(e)),nn--,(t=e)===n&&(e=n,0===nn&&fn(Rr)),t}function Pn(){var t,e,s,u,o,a,c,i;if(nn++,t=Ve,e=Ve,s=Ve,91===r.charCodeAt(Ve)?(u=Dr,Ve++):(u=n,0===nn&&fn(Pr)),u!==n&&(o=is())!==n?(93===r.charCodeAt(Ve)?(a=Fr,Ve++):(a=n,0===nn&&fn(Ur)),a!==n?s=u=[u,o,a]:(Ve=s,s=n)):(Ve=s,s=n),s===n)if(s=Ve,91===r.charCodeAt(Ve)?(u=Dr,Ve++):(u=n,0===nn&&fn(Pr)),u!==n)if((o=is())!==n)if(123===r.charCodeAt(Ve)?(a="{",Ve++):(a=n,0===nn&&fn(jr)),a!==n){for(c=[],(i=Pn())===n&&(qr.test(r.charAt(Ve))?(i=r.charAt(Ve),Ve++):(i=n,0===nn&&fn(Mr)));i!==n;)c.push(i),(i=Pn())===n&&(qr.test(r.charAt(Ve))?(i=r.charAt(Ve),Ve++):(i=n,0===nn&&fn(Mr)));c!==n?(93===r.charCodeAt(Ve)?(i=Fr,Ve++):(i=n,0===nn&&fn(Ur)),i!==n?s=u=[u,o,a,c,i]:(Ve=s,s=n)):(Ve=s,s=n)}else Ve=s,s=n;else Ve=s,s=n;else Ve=s,s=n;return(e=s!==n?r.substring(e,Ve):s)!==n&&(t,e=Sr(e)),nn--,(t=e)===n&&(e=n,0===nn&&fn(zr)),t}function Fn(){var t,e,s;return t=Ve,e=function(){var t,e,s;if(nn++,t=Ve,e=[],Wr.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(Gr)),s!==n)for(;s!==n;)e.push(s),Wr.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(Gr));else e=n;return t=e!==n?r.substring(t,Ve):e,nn--,t===n&&(e=n,0===nn&&fn(Qr)),t}(),e!==n&&as()!==n?(s=function(){var r,t,e,s,u;if(r=Ve,(t=Nn())!==n){for(e=[],s=Ve,os()!==n&&(u=Nn())!==n?(s,s=Hr(0,u)):(Ve=s,s=n);s!==n;)e.push(s),s=Ve,os()!==n&&(u=Nn())!==n?(s,s=Hr(0,u)):(Ve=s,s=n);e!==n?(r,r=t={a:t,more:e}):(Ve=r,r=n)}else Ve=r,r=n;return r}(),s!==n&&cs()!==n?(t,t=e=function(r,t){if(hs&&!(r.toLowerCase()in hs.functions))throw Object.assign(new Error(`"${r}" is an unknown function in OData URL spec (strict mode)`),{statusCode:400});return{func:r.toLowerCase(),args:[t.a,...t.more]}}(e,s)):(Ve=t,t=n)):(Ve=t,t=n),t}function Un(){var t,e;return t=Ve,is()!==n?("not"===r.substr(Ve,3).toLowerCase()?(e=r.substr(Ve,3),Ve+=3):(e=n,0===nn&&fn(st)),e!==n&&fs()!==n?(t,t="not"):(Ve=t,t=n)):(Ve=t,t=n),t}function qn(){var t,e;return t=Ve,fs()!==n?("and"===r.substr(Ve,3).toLowerCase()?(e=r.substr(Ve,3),Ve+=3):(e=n,0===nn&&fn(ut)),e!==n&&fs()!==n?(t,t="and"):(Ve=t,t=n)):(Ve=t,t=n),t}function Mn(){var r,t;return r=Ve,(t=fs())!==n&&(r,t="and"),r=t}function In(){var t,e;return t=Ve,fs()!==n?("or"===r.substr(Ve,2).toLowerCase()?(e=r.substr(Ve,2),Ve+=2):(e=n,0===nn&&fn(ot)),e!==n&&fs()!==n?(t,t="or"):(Ve=t,t=n)):(Ve=t,t=n),t}function Yn(){var t,e,s;return t=Ve,r.substr(Ve,9)===at?(e=at,Ve+=9):(e=n,0===nn&&fn(ct)),e!==n?(s=function(){var r,t,e,s,u;if(r=Ve,as()!==n)if(is()!==n)if((t=Xn())!==n){for(e=[],s=Ve,is()!==n&&os()!==n&&is()!==n&&(u=Xn())!==n?(s,s=_t(0,u)):(Ve=s,s=n);s!==n;)e.push(s),s=Ve,is()!==n&&os()!==n&&is()!==n&&(u=Xn())!==n?(s,s=_t(0,u)):(Ve=s,s=n);e!==n&&(s=is())!==n&&cs()!==n?(r,o=e,r={aggregate:[t,...o]}):(Ve=r,r=n)}else Ve=r,r=n;else Ve=r,r=n;else Ve=r,r=n;var o;return r}(),s!==n?(t,t=e=s):(Ve=t,t=n)):(Ve=t,t=n),t===n&&(t=Ve,r.substr(Ve,7)===it?(e=it,Ve+=7):(e=n,0===nn&&fn(ft)),e!==n?(s=function(){var r,t,e,s,u,o,a,c;if(r=Ve,(t=as())!==n)if(as()!==n)if((e=Hn())!==n){for(s=[],u=Ve,(o=os())!==n&&(a=Hn())!==n?(u,u=o=_t(0,a)):(Ve=u,u=n);u!==n;)s.push(u),u=Ve,(o=os())!==n&&(a=Hn())!==n?(u,u=o=_t(0,a)):(Ve=u,u=n);s!==n?(u=Ve,(o=cs())!==n&&(u,i=s,o={groupBy:[e,...i]}),(u=o)!==n?(o=Ve,(a=os())!==n&&(c=On())!==n?(o,o=a=c):(Ve=o,o=n),o===n&&(o=null),o!==n&&(a=cs())!==n?(r,t=function(r,t,e){let n={};return n=e?{groupBy:[r,...t],...e.apply}:{groupBy:[r,...t]},n}(e,s,o),r=t):(Ve=r,r=n)):(Ve=r,r=n)):(Ve=r,r=n)}else Ve=r,r=n;else Ve=r,r=n;else Ve=r,r=n;var i;return r}(),s!==n?(t,t=e=s):(Ve=t,t=n)):(Ve=t,t=n),t===n&&(t=Ve,r.substr(Ve,6)===lt?(e=lt,Ve+=6):(e=n,0===nn&&fn(ht)),e!==n?(s=function(){var r,t,e;r=Ve,as()!==n&&is()!==n?(t=Ve,(e=$n())!==n&&t,(t=e)!==n&&(e=is())!==n&&cs()!==n?(r,r={where:t}):(Ve=r,r=n)):(Ve=r,r=n);return r}(),s!==n?(t,t=e=s):(Ve=t,t=n)):(Ve=t,t=n),t===n&&(t=Ve,r.substr(Ve,6)===pt?(e=pt,Ve+=6):(e=n,0===nn&&fn(At)),e!==n?(s=function(){var r,t,e;r=Ve,as()!==n&&is()!==n?(t=Ve,(e=xn())!==n&&(t,e=function(r){if(r)return r}(e)),(t=e)!==n&&(e=is())!==n&&cs()!==n?(r,r={search:t}):(Ve=r,r=n)):(Ve=r,r=n);return r}(),s!==n?(t,t=e=s):(Ve=t,t=n)):(Ve=t,t=n),t===n&&(t=Ve,r.substr(Ve,6)===dt?(e=dt,Ve+=6):(e=n,0===nn&&fn(gt)),e!==n?(s=function(){var r,t,e,s,u;if(r=Ve,as()!==n)if(is()!==n)if((t=On())!==n){if(e=[],s=Ve,is()!==n&&os()!==n&&is()!==n&&(u=On())!==n?(s,s=Ft(0,u)):(Ve=s,s=n),s!==n)for(;s!==n;)e.push(s),s=Ve,is()!==n&&os()!==n&&is()!==n&&(u=On())!==n?(s,s=Ft(0,u)):(Ve=s,s=n);else e=n;e!==n&&(s=is())!==n&&cs()!==n?(r,o=e,r={concat:[t,...o]}):(Ve=r,r=n)}else Ve=r,r=n;else Ve=r,r=n;else Ve=r,r=n;var o;return r}(),s!==n?(t,t=e=s):(Ve=t,t=n)):(Ve=t,t=n),t===n&&(t=Ve,r.substr(Ve,7)===vt?(e=vt,Ve+=7):(e=n,0===nn&&fn(mt)),e!==n?(s=function(){var r,t,e,s,u,o,a,c,i,f;if(r=Ve,(t=as())!==n)if((e=is())!==n)if((s=Kn())!==n){for(u=[],o=Ve,(a=is())!==n&&(c=os())!==n&&(i=is())!==n&&(f=Kn())!==n?o=a=[a,c,i,f]:(Ve=o,o=n);o!==n;)u.push(o),o=Ve,(a=is())!==n&&(c=os())!==n&&(i=is())!==n&&(f=Kn())!==n?o=a=[a,c,i,f]:(Ve=o,o=n);u!==n&&(o=is())!==n&&(a=cs())!==n?r=t=[t,e,s,u,o,a]:(Ve=r,r=n)}else Ve=r,r=n;else Ve=r,r=n;else Ve=r,r=n;return r}(),s!==n?(t,t=e=s):(Ve=t,t=n)):(Ve=t,t=n),t===n&&(t=Ve,"top"===r.substr(Ve,3)?(e="top",Ve+=3):(e=n,0===nn&&fn(bt)),e!==n?(s=function(){var r,t;r=Ve,as()!==n&&is()!==n&&(t=Cn())!==n&&is()!==n&&cs()!==n?(r,r={limit:{rows:{val:t}}}):(Ve=r,r=n);return r}(),s!==n?(t,t=e=s):(Ve=t,t=n)):(Ve=t,t=n),t===n&&(t=Ve,r.substr(Ve,4)===yt?(e=yt,Ve+=4):(e=n,0===nn&&fn(Ct)),e!==n?(s=function(){var r,t;r=Ve,as()!==n&&is()!==n&&(t=wn())!==n&&is()!==n&&cs()!==n?(r,r={limit:{offset:{val:t}}}):(Ve=r,r=n);return r}(),s!==n?(t,t=e=s):(Ve=t,t=n)):(Ve=t,t=n),t===n&&(t=Ve,r.substr(Ve,7)===wt?(e=wt,Ve+=7):(e=n,0===nn&&fn(xt)),e!==n?(s=function(){var r,t,e,s,u;if(r=Ve,as()!==n)if(is()!==n)if((t=_n())!==n){for(e=[],s=Ve,os()!==n&&(u=_n())!==n?(s,s=Mt(0,u)):(Ve=s,s=n);s!==n;)e.push(s),s=Ve,os()!==n&&(u=_n())!==n?(s,s=Mt(0,u)):(Ve=s,s=n);e!==n&&(s=is())!==n&&cs()!==n?(r,o=e,r={orderBy:[t,...o]}):(Ve=r,r=n)}else Ve=r,r=n;else Ve=r,r=n;else Ve=r,r=n;var o;return r}(),s!==n?(t,t=e=s):(Ve=t,t=n)):(Ve=t,t=n),t===n&&(t=Ve,"topcount"===r.substr(Ve,8).toLowerCase()?(e=r.substr(Ve,8),Ve+=8):(e=n,0===nn&&fn(Et)),e===n&&("bottomcount"===r.substr(Ve,11).toLowerCase()?(e=r.substr(Ve,11),Ve+=11):(e=n,0===nn&&fn($t)),e===n&&("topsum"===r.substr(Ve,6).toLowerCase()?(e=r.substr(Ve,6),Ve+=6):(e=n,0===nn&&fn(Lt)),e===n&&("bottomsum"===r.substr(Ve,9).toLowerCase()?(e=r.substr(Ve,9),Ve+=9):(e=n,0===nn&&fn(Bt)),e===n&&("toppercent"===r.substr(Ve,10).toLowerCase()?(e=r.substr(Ve,10),Ve+=10):(e=n,0===nn&&fn(St)),e===n&&("bottompercent"===r.substr(Ve,13).toLowerCase()?(e=r.substr(Ve,13),Ve+=13):(e=n,0===nn&&fn(Tt))))))),e!==n?(s=function(){var r,t,e;r=Ve,as()!==n&&is()!==n&&(t=Nn())!==n&&is()!==n&&os()!==n&&is()!==n&&(e=Nn())!==n&&is()!==n&&cs()!==n?(r,r=[t,e]):(Ve=r,r=n);return r}(),s!==n?(t,t=e=function(r,t){if(!{topcount:!0,bottomcount:!0,topsum:!1,bottomsum:!1,toppercent:!1,bottompercent:!1}[r=r.toLowerCase()])throw Object.assign(new Error(`Transformation "${r}" in $apply is not yet supported.`),{statusCode:501});return{aggregate:[{func:r,args:t}]}}(e,s)):(Ve=t,t=n)):(Ve=t,t=n),t===n&&(t=Ve,e=function(){var t,e;t=Ve,r.substr(Ve,8)===Ut?(e=Ut,Ve+=8):(e=n,0===nn&&fn(qt));e!==n&&(t,e={identity:!0});return t=e}(),e!==n&&t,t=e)))))))))),t}function Xn(){var t,e,s,u;return t=Ve,e=Ve,r.substr(Ve,6)===f?(s=f,Ve+=6):(s=n,0===nn&&fn(l)),s!==n&&(u=Gn())!==n?(e,e=s={func:"count",args:[{val:1}],as:u}):(Ve=e,e=n),e===n&&(e=Jn()),e!==n&&t,t=e}function Jn(){var r,t,e,s,u;return r=Ve,(t=kn())!==n?((e=Qn())===n&&(e=null),e!==n?((s=Wn())===n&&(s=null),s!==n?((u=Gn())===n&&(u=null),u!==n?(r,r=t={func:e,args:[t],as:u}):(Ve=r,r=n)):(Ve=r,r=n)):(Ve=r,r=n)):(Ve=r,r=n),r===n&&(r=Ve,(t=es())!==n&&(e=as())!==n&&(s=Jn())!==n&&(u=cs())!==n?r=t=[t,e,s,u]:(Ve=r,r=n)),r}function Qn(){var t,e,s,u,o;if(t=Ve,fs()!==n)if(r.substr(Ve,4)===Ot?(e=Ot,Ve+=4):(e=n,0===nn&&fn(Rt)),e!==n)if(fs()!==n){if(s=Ve,u=[],Wr.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(Gr)),o!==n)for(;o!==n;)u.push(o),Wr.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(Gr));else u=n;(s=u!==n?r.substring(s,Ve):u)!==n?(t,t=s.toLowerCase()):(Ve=t,t=n)}else Ve=t,t=n;else Ve=t,t=n;else Ve=t,t=n;return t}function Wn(){var t,e,s,u,o,a,c;return t=Ve,(e=fs())!==n?(r.substr(Ve,4)===jt?(s=jt,Ve+=4):(s=n,0===nn&&fn(Zt)),s!==n&&(u=fs())!==n&&(o=kn())!==n&&(a=Qn())!==n?((c=Wn())===n&&(c=null),c!==n?t=e=[e,s,u,o,a,c]:(Ve=t,t=n)):(Ve=t,t=n)):(Ve=t,t=n),t}function Gn(){var t,e,s;return t=Ve,fs()!==n?("as"===r.substr(Ve,2)?(e="as",Ve+=2):(e=n,0===nn&&fn(Nt)),e!==n&&fs()!==n&&(s=es())!==n?(t,t=s):(Ve=t,t=n)):(Ve=t,t=n),t}function Hn(){var t,e;return t=Ve,e=function(){var t,e,s,u,o,a,c,i,f,l,h;t=Ve,e=Ve,r.substr(Ve,6)===kt?(s=kt,Ve+=6):(s=n,0===nn&&fn(zt));if(s!==n)if((u=as())!==n)if((o=is())!==n)if(r.substr(Ve,4)===Dt?(a=Dt,Ve+=4):(a=n,0===nn&&fn(Pt)),a===n&&(a=kn()),a!==n){if(c=[],i=Ve,(f=is())!==n&&(l=os())!==n&&(h=kn())!==n?i=f=[f,l,h]:(Ve=i,i=n),i!==n)for(;i!==n;)c.push(i),i=Ve,(f=is())!==n&&(l=os())!==n&&(h=kn())!==n?i=f=[f,l,h]:(Ve=i,i=n);else c=n;c!==n&&(i=is())!==n&&(f=cs())!==n?e=s=[s,u,o,a,c,i,f]:(Ve=e,e=n)}else Ve=e,e=n;else Ve=e,e=n;else Ve=e,e=n;else Ve=e,e=n;e!==n&&(t,e=function(r){const t=new Error("Rollup in groupby is not supported yet.");throw t.statusCode=501,t}());return t=e}(),e===n&&(e=kn()),e!==n&&t,t=e}function Kn(){var r,t,e;return r=Ve,(t=Ln())!==n&&(e=Gn())!==n?r=t=[t,e]:(Ve=r,r=n),r}function Vn(){var t,e;return nn++,t=Ve,r.substr(Ve,4)===Yt?(e=Yt,Ve+=4):(e=n,0===nn&&fn(Xt)),e===n&&(r.substr(Ve,5)===Jt?(e=Jt,Ve+=5):(e=n,0===nn&&fn(Qt))),e!==n&&(t,e="true"===e),nn--,(t=e)===n&&(e=n,0===nn&&fn(It)),t}function rs(){var t,e,s,u,o;if(nn++,t=Ve,39===r.charCodeAt(Ve)?(e=Gt,Ve++):(e=n,0===nn&&fn(Ht)),e!==n){for(s=Ve,u=[],r.substr(Ve,2)===Kt?(o=Kt,Ve+=2):(o=n,0===nn&&fn(Vt)),o===n&&(re.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(te)));o!==n;)u.push(o),r.substr(Ve,2)===Kt?(o=Kt,Ve+=2):(o=n,0===nn&&fn(Vt)),o===n&&(re.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(te)));(s=u!==n?r.substring(s,Ve):u)!==n?(39===r.charCodeAt(Ve)?(u=Gt,Ve++):(u=n,0===nn&&fn(Ht)),u!==n?(t,t=e=s.replace(/''/g,"'")):(Ve=t,t=n)):(Ve=t,t=n)}else Ve=t,t=n;return nn--,t===n&&(e=n,0===nn&&fn(Wt)),t}function ts(){var t,e,s,u,o,a;if(nn++,t=Ve,e=Ve,s=Ve,xe.test(r.charAt(Ve))?(u=r.charAt(Ve),Ve++):(u=n,0===nn&&fn(Ee)),u===n&&(u=null),u!==n){if(o=[],pe.test(r.charAt(Ve))?(a=r.charAt(Ve),Ve++):(a=n,0===nn&&fn(Ae)),a!==n)for(;a!==n;)o.push(a),pe.test(r.charAt(Ve))?(a=r.charAt(Ve),Ve++):(a=n,0===nn&&fn(Ae));else o=n;o!==n?s=u=[u,o]:(Ve=s,s=n)}else Ve=s,s=n;return(e=s!==n?r.substring(e,Ve):s)!==n&&(t,e=parseInt(e)),nn--,(t=e)===n&&(e=n,0===nn&&fn(Le)),t}function es(){var t,e,s,u,o,a,c,i;if(nn++,t=Ve,e=Ve,nn++,s=Vn(),nn--,s===n?e=void 0:(Ve=e,e=n),e!==n)if(s=Ve,nn++,u=ns(),nn--,u===n?s=void 0:(Ve=s,s=n),s!==n){if(u=Ve,o=Ve,Se.test(r.charAt(Ve))?(a=r.charAt(Ve),Ve++):(a=n,0===nn&&fn(Te)),a!==n){for(c=[],_e.test(r.charAt(Ve))?(i=r.charAt(Ve),Ve++):(i=n,0===nn&&fn(Oe));i!==n;)c.push(i),_e.test(r.charAt(Ve))?(i=r.charAt(Ve),Ve++):(i=n,0===nn&&fn(Oe));c!==n?o=a=[a,c]:(Ve=o,o=n)}else Ve=o,o=n;(u=o!==n?r.substring(u,Ve):o)!==n?(t,t=e=u):(Ve=t,t=n)}else Ve=t,t=n;else Ve=t,t=n;return nn--,t===n&&(e=n,0===nn&&fn(Be)),t}function ns(){var t,e,s,u,o,a,c,i,f,l,h,p,A,d;return nn++,t=Ve,e=Ve,(s=ss())!==n&&(u=ss())!==n?(45===r.charCodeAt(Ve)?(o=de,Ve++):(o=n,0===nn&&fn(ge)),o===n&&(o=null),o!==n&&(a=ss())!==n?(45===r.charCodeAt(Ve)?(c=de,Ve++):(c=n,0===nn&&fn(ge)),c===n&&(c=null),c!==n&&(i=ss())!==n?(45===r.charCodeAt(Ve)?(f=de,Ve++):(f=n,0===nn&&fn(ge)),f===n&&(f=null),f!==n&&(l=ss())!==n?(45===r.charCodeAt(Ve)?(h=de,Ve++):(h=n,0===nn&&fn(ge)),h===n&&(h=null),h!==n&&(p=ss())!==n&&(A=ss())!==n&&(d=ss())!==n?e=s=[s,u,o,a,c,i,f,l,h,p,A,d]:(Ve=e,e=n)):(Ve=e,e=n)):(Ve=e,e=n)):(Ve=e,e=n)):(Ve=e,e=n),t=e!==n?r.substring(t,Ve):e,nn--,t===n&&(e=n,0===nn&&fn(Re)),t}function ss(){var t,e,s,u,o,a;return nn++,t=Ve,e=Ve,Ze.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(Ne)),s!==n?(Ze.test(r.charAt(Ve))?(u=r.charAt(Ve),Ve++):(u=n,0===nn&&fn(Ne)),u!==n?(Ze.test(r.charAt(Ve))?(o=r.charAt(Ve),Ve++):(o=n,0===nn&&fn(Ne)),o!==n?(Ze.test(r.charAt(Ve))?(a=r.charAt(Ve),Ve++):(a=n,0===nn&&fn(Ne)),a!==n?e=s=[s,u,o,a]:(Ve=e,e=n)):(Ve=e,e=n)):(Ve=e,e=n)):(Ve=e,e=n),t=e!==n?r.substring(t,Ve):e,nn--,t===n&&(e=n,0===nn&&fn(je)),t}function us(){var t,e,s,u;if(t=Ve,e=Ve,s=[],ke.test(r.charAt(Ve))?(u=r.charAt(Ve),Ve++):(u=n,0===nn&&fn(ze)),u!==n)for(;u!==n;)s.push(u),ke.test(r.charAt(Ve))?(u=r.charAt(Ve),Ve++):(u=n,0===nn&&fn(ze));else s=n;return(e=s!==n?r.substring(e,Ve):s)!==n&&(t,e={val:e}),t=e}function os(){var t,e,s,u;return t=Ve,(e=is())!==n?(44===r.charCodeAt(Ve)?(s=Yr,Ve++):(s=n,0===nn&&fn(Xr)),s!==n&&(u=is())!==n?t=e=[e,s,u]:(Ve=t,t=n)):(Ve=t,t=n),t}function as(){var t,e,s,u;return t=Ve,(e=is())!==n?(40===r.charCodeAt(Ve)?(s="(",Ve++):(s=n,0===nn&&fn(Je)),s!==n&&(u=is())!==n?t=e=[e,s,u]:(Ve=t,t=n)):(Ve=t,t=n),t}function cs(){var t,e,s;return t=Ve,(e=is())!==n?(41===r.charCodeAt(Ve)?(s=")",Ve++):(s=n,0===nn&&fn(Qe)),s!==n?t=e=[e,s]:(Ve=t,t=n)):(Ve=t,t=n),t}function is(){var t,e,s;for(nn++,t=Ve,e=[],Ge.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(He));s!==n;)e.push(s),Ge.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(He));return t=e!==n?r.substring(t,Ve):e,nn--,t===n&&(e=n,0===nn&&fn(We)),t}function fs(){var t,e,s;if(nn++,t=Ve,e=[],Ge.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(He)),s!==n)for(;s!==n;)e.push(s),Ge.test(r.charAt(Ve))?(s=r.charAt(Ve),Ve++):(s=n,0===nn&&fn(He));else e=n;return t=e!==n?r.substring(t,Ve):e,nn--,t===n&&(e=n,0===nn&&fn(Ke)),t}const ls=Object.assign,{strict:hs,minimal:ps}=t,As=[];let ds,gs;const vs=["$value"],ms=t.safeNumber||function(r){const t=Number(r);return Number.isSafeInteger(t)?t:r},bs=t.standardBase64||function(r){return Buffer.from(r,"base64").toString("base64")},ys=r=>t=>r===t||r.as&&t.as&&r.as===t.as||t.as&&r.ref&&t.as===r.ref[r.ref.length-1]||r.ref&&t.ref&&r.ref.join("")===t.ref.join(""),Cs=r=>t=>{if(Array.isArray(t))return t.map(Cs(r));const e=t.ref&&r.find((r=>r.as&&r.func&&r.as===t.ref[0]));return e||t},ws=r=>t=>Array.isArray(t)?t.map(ws(r)):t.ref&&!r.find(ys(t))?{val:null}:t,xs=(r,t)=>{if(1===t.ref.length)r.find(ys(t))||r.push(t);else{const e=t.ref.shift(),n=r.find((r=>r.ref&&r.ref[0]===e));if(n)xs(n.expand,t);else{const n={ref:[e],expand:[]};xs(n.expand,t),r.push(n)}}},Es=(r,t,e=!1)=>{let n=Bs({from:r.from},t,e);if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=$s(n[t],r,e);else n=$s(n,r,e);return n},$s=(r,t,e)=>{if(!t)return r;t.apply&&delete t.apply;let n={};t.columns&&"$count"===t.columns[0].as||r.SELECT.where&&t.where||r.SELECT.limit&&t.limit||r.SELECT.orderBy&&t.orderBy||r.SELECT.search&&t.search?n.from=r:n=r.SELECT;for(const r in t)"columns"===r?(t.columns=t.columns.map((r=>n.columns&&n.columns.find((t=>r.ref&&r.ref[0]===t.as||t.ref&&r.ref&&r.ref[0]===t.ref[0]&&!r.expand))||r)),n.columns&&n.groupBy&&t.columns.push(...n.columns.filter((r=>e&&n.groupBy.find((t=>r.ref&&r.ref[0]===t.ref[0]))&&!t.columns.some((t=>t.ref&&t.ref[0]===r.as||t.ref&&r.ref&&t.ref[0]===r.ref[0]||t.as&&t.as===r.as))))||[]),n.columns=t.columns):"from"!==r&&(n[r]=t[r]);const s=[...n.columns&&n.columns.filter((r=>n.groupBy&&n.groupBy.find((t=>r.ref&&r.ref[0]===t.ref[0]))))||[],...n.columns&&n.columns.filter((r=>r&&"object"==typeof r&&"func"in r))||[]];return Ls(n,s,e),{SELECT:n}},Ls=(r,t,e)=>{t.length&&(r.columns=r.columns&&!e?r.columns.reduce(((r,e)=>{const n=t.find(ys(e));return n&&r.push(n),r}),[]):t,r.where&&(r.where=r.where.map(Cs(r.columns)),r.groupBy&&(r.having=r.where.map(ws(r.groupBy)),delete r.where)),r.columns=r.columns.reduce(((r,e)=>(e.ref&&e.ref.length>1&&t.find(ys(e))?xs(r,{ref:[...e.ref]}):r.push(e),r)),[]))},Bs=(r,t,e)=>{if(!t)return;if(r.apply&&delete r.apply,t.identity&&r.from.SELECT&&(r=r.from.SELECT),(t.apply||t.where&&r.where||t.search&&r.search||t.limit&&r.limit||t.orderBy&&r.orderBy)&&(r.from={SELECT:{...r}}),t.where&&(r.where=t.where),t.search&&(r.search=t.search),t.groupBy){r.groupBy=[];for(const e of t.groupBy)r.groupBy.find(ys(e))||r.groupBy.push(e)}t.limit&&(r.limit=t.limit),t.orderBy&&(r.orderBy=t.orderBy);const n=[...r.groupBy||[],...t.aggregate||[]];if(Ls(r,n,e),t.apply&&r.from&&Bs(r.from.SELECT,t.apply),t.concat&&Array.isArray(t.concat)){const e=[];for(let n of t.concat){n.from=1===Object.keys(r).length?r.from:{SELECT:r};const t=Bs(n,n.apply);Array.isArray(t)?e.push(...t):e.push(t)}r=e}return Array.isArray(r)?r:{SELECT:r}},Ss=r=>{ds.limit&&ds.limit.offset&&ds.limit.offset.val&&(r+=ds.limit.offset.val),(ds.limit||(ds.limit={})).offset={val:r}},Ts=(r,t=!1)=>{ds.orderBy=ds.orderBy?t?[r,...ds.orderBy]:[...ds.orderBy,r]:[r]},_s=(r,t)=>{for(const e of t)e.ref&&e.ref[0]===r&&e.ref.shift(),e.func&&_s(r,e.args);return t};if((e=u())!==n&&Ve===r.length)return e;throw e!==n&&Ve<r.length&&fn({type:"end"}),ln(en,tn<r.length?r.charAt(tn):null,tn<r.length?cn(tn,tn+1):cn(tn,tn))}peg$subclass(peg$SyntaxError,Error),peg$SyntaxError.buildMessage=function(r,t){var e={literal:function(r){return'"'+s(r.text)+'"'},class:function(r){var t,e="";for(t=0;t<r.parts.length;t++)e+=r.parts[t]instanceof Array?u(r.parts[t][0])+"-"+u(r.parts[t][1]):u(r.parts[t]);return"["+(r.inverted?"^":"")+e+"]"},any:function(r){return"any character"},end:function(r){return"end of input"},other:function(r){return r.description}};function n(r){return r.charCodeAt(0).toString(16).toUpperCase()}function s(r){return r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+n(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+n(r)}))}function u(r){return r.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+n(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+n(r)}))}return"Expected "+function(r){var t,n,s,u=new Array(r.length);for(t=0;t<r.length;t++)u[t]=(s=r[t],e[s.type](s));if(u.sort(),u.length>0){for(t=1,n=1;t<u.length;t++)u[t-1]!==u[t]&&(u[n]=u[t],n++);u.length=n}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}(r)+" but "+function(r){return r?'"'+s(r)+'"':"end of input"}(t)+" found."},module.exports={SyntaxError:peg$SyntaxError,parse:peg$parse};
